# LedMatrix — Техническое описание класса управления LED-матрицей для ESP32

---

## Назначение

**LedMatrix** — это C++ класс для управления адресной светодиодной матрицей (WS2812B и совместимые) на базе ESP32 с поддержкой сохранения и конфигурирования параметров через JSON и NVS. Класс предназначен для использования в проектах, где требуется динамическое управление светом, интеграция с веб-интерфейсом или удалённая настройка.

---

## Основные характеристики

- **Аппаратная поддержка:** WS2812B/NeoPixel, ESP32
- **Гибкая настройка параметров:** яркость, цвет, режимы (расширяемо)
- **Сохранение параметров:** NVS (Non-Volatile Storage, Flash ESP32)
- **JSON API:** сериализация/десериализация параметров для интеграции с веб-интерфейсом или REST API
- **Безопасность:** строгая проверка границ, логирование ошибок
- **Расширяемость:** поддержка пользовательских настроек через интерфейс `ConfigurableBase`

---

## Интерфейс класса

```cpp
class LedMatrix : public ConfigurableBase {
public:
    LedMatrix();
    void begin(); // Инициализация FastLED и загрузка настроек
    void clear(); // Очистка матрицы (все пиксели = черный)
    void setPixel(int x, int y, const CRGB& color); // Установка цвета пикселя
    void setBrightness(uint8_t brightness); // Установка яркости
    int getBrightness() const;
    void update(); // Применить изменения (FastLED.show)
    void off(); // Очистить и выключить матрицу
    CRGB* getLeds(); // Доступ к массиву пикселей
    int XY(int x, int y); // Преобразование координат
    int getWidth() const;
    int getHeight() const;
    int getNumLeds() const;
    bool fromJSON(const JsonObject& obj) override; // Применить настройки из JSON
    bool resetConfig() override; // Сбросить настройки к значениям по умолчанию
};

